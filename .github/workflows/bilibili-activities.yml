name: Bilibili Data
on:
  schedule:
    # Runs every hour
    - cron: '0 * * * *'
  workflow_dispatch:

jobs:
  recent-uploads:
    name: Recent Uploads
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: gautamkrishnar/blog-post-workflow@master
        with:
          committer_username: "QubitPi"
          committer_email: "jack20220723@gmail.com"
          commit_message: "New Bilibili Uploads"
          comment_tag_name: "BILIBILI-UPLOAD-LIST"
          max_post_count: "3"
          feed_list: "https://rsshub.app/bilibili/user/video/1771839550"
  recent-activities:
    name: Recent Activities (Including Recent Uploads)
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: gautamkrishnar/blog-post-workflow@master
        with:
          committer_username: "QubitPi"
          committer_email: "jack20220723@gmail.com"
          commit_message: "New Bilibili Activities"
          comment_tag_name: "BILIBILI-RECENT-ACTIVITIES"
          max_post_count: "5"
          feed_list: "https://rsshub.app/bilibili/user/dynamic/1771839550"
  followings:
    name: Followings
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: gautamkrishnar/blog-post-workflow@master
        with:
          committer_username: "QubitPi"
          committer_email: "jack20220723@gmail.com"
          commit_message: "New Bilibili Following"
          comment_tag_name: "BILIBILI-FOLLWOING"
          max_post_count: "10"
          feed_list: "https://rsshub.app/bilibili/user/followings/1771839550"
          item_exec: |
                    post.title = post.title.replace('活泼到令人头疼的胡桃 新关注 ','');
          template: "<li><a href=$url>$title</a></li>"
  trippled-videos:
    name: Trippled Videos
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: gautamkrishnar/blog-post-workflow@master
        with:
          committer_username: "QubitPi"
          committer_email: "jack20220723@gmail.com"
          commit_message: "New Liked-Saved-Tipped Videos"
          comment_tag_name: "BILIBILI-TIPPED-VIDEOS"
          max_post_count: "5"
          feed_list: "https://rsshub.app/bilibili/user/coin/1771839550"
          # extract 1st double-quoted strings
          item_exec: |
                    post.description = post.description.match(/(?:img src="[^"]*"|^[^"]*$)/)[0].replace(/"/g, "").replace("img src=", "");
          template: "<a href=$url>$title</a>  <img src=$description width='5%'>"
  columns:
    name: Columns
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: gautamkrishnar/blog-post-workflow@master
        with:
          committer_username: "QubitPi"
          committer_email: "jack20220723@gmail.com"
          commit_message: "New Bilibili Article Published"
          comment_tag_name: "BILIBILI-COLUMNS"
          max_post_count: "5"
          feed_list: "https://rsshub.app/bilibili/user/article/1771839550"    
